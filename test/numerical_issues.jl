P = [
    1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64;
    2 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 2 88 89 66 90 68 71 91 92 93 94 84 95 96 97 98 99 100 90 101 72 76 77 102 103 82 81 104 105 106 107 83 94 108 109 93 110 95 111 98;
    3 66 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 28 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172;
    4 67 113 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 4 194 195 113 196 174 177 197 198 199 200 190 201 202 203 204 205 206 196 207 178 182 183 208 209 188 187 210 211 212 213 189 200 214 215 199 216 201 217 204;
    5 68 114 174 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 30 238 239 138 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275;
    6 69 115 175 219 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 6 295 296 115 297 219 278 298 299 300 301 291 302 303 304 305 306 307 297 308 279 283 284 309 310 289 288 311 312 313 314 290 301 315 316 300 317 302 318 305;
    7 70 116 176 220 277 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 7 337 338 116 339 220 320 340 341 342 343 333 344 345 346 347 348 349 339 350 321 325 326 351 352 331 330 353 354 355 356 332 343 357 358 342 359 344 360 347;
    8 71 117 177 221 278 320 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 376 377 31 378 379 139 380 242 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395 396 397 398 399 400 401 402 403 404 405 406 407 408 409 410 411 412 413 414;
    9 72 118 178 222 279 321 362 415 416 417 418 419 420 421 422 423 424 425 426 427 428 429 430 45 431 432 153 433 256 395 434 435 436 437 438 439 440 441 442 443 444 445 446 447 448 449 450 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466;
    10 73 119 179 223 280 322 363 416 467 468 469 470 471 472 473 474 475 476 477 478 479 480 481 10 482 483 119 484 223 363 485 486 487 488 478 489 490 491 492 493 494 484 495 416 470 471 496 497 476 475 498 499 500 501 477 488 502 503 487 504 489 505 492;
    11 74 120 180 224 281 323 364 417 468 506 507 508 509 510 511 512 513 514 515 516 517 518 519 11 520 521 120 522 224 364 523 524 525 526 516 527 528 529 530 531 532 522 533 417 508 509 534 535 514 513 536 537 538 539 515 526 540 541 525 542 527 543 530;
    12 75 121 181 225 282 324 365 418 469 507 544 545 546 547 548 549 550 551 552 553 554 555 556 12 557 558 121 559 225 365 560 561 562 563 553 564 565 566 567 568 569 559 570 418 545 546 571 572 551 550 573 574 575 576 552 563 577 578 562 579 564 580 567;
    13 76 122 182 226 283 325 366 419 470 508 545 581 582 583 584 585 586 587 588 589 590 591 592 46 593 594 154 595 257 396 596 597 598 599 600 601 602 603 604 605 606 607 608 448 609 610 611 612 613 614 615 616 617 618 619 620 621 622 623 624 625 626 627;
    14 77 123 183 227 284 326 367 420 471 509 546 582 628 629 630 631 632 633 634 635 636 637 638 47 639 640 155 641 258 397 642 643 644 645 646 647 648 649 650 651 652 653 654 449 610 655 656 657 658 659 660 661 662 663 664 665 666 667 668 669 670 671 672;
    15 78 124 184 228 285 327 368 421 472 510 547 583 629 673 674 675 676 677 678 679 680 681 682 15 683 684 124 685 228 368 686 687 688 689 679 690 691 692 693 694 695 685 696 421 583 629 697 698 677 676 699 700 701 702 678 689 703 704 688 705 690 706 693;
    16 79 125 185 229 286 328 369 422 473 511 548 584 630 674 707 708 709 710 711 712 713 714 715 16 716 717 125 718 229 369 719 720 721 722 712 723 724 725 726 727 728 718 729 422 584 630 730 731 710 709 732 733 734 735 711 722 736 737 721 738 723 739 726;
    17 80 126 186 230 287 329 370 423 474 512 549 585 631 675 708 740 741 742 743 744 745 746 747 17 748 749 126 750 230 370 751 752 753 754 744 755 756 757 758 759 760 750 761 423 585 631 762 763 742 741 764 765 766 767 743 754 768 769 753 770 755 771 758;
    18 81 127 187 231 288 330 371 424 475 513 550 586 632 676 709 741 772 773 774 775 776 777 778 51 779 780 159 781 262 401 782 783 784 785 786 787 788 789 790 791 792 793 794 453 614 659 795 796 797 798 799 800 801 802 803 804 805 806 807 808 809 810 811;
    19 82 128 188 232 289 331 372 425 476 514 551 587 633 677 710 742 773 812 813 814 815 816 817 50 818 819 158 820 261 400 821 822 823 824 825 826 827 828 829 830 831 832 833 452 613 658 834 835 836 797 837 838 839 840 841 842 843 844 845 846 847 848 849;
    20 83 129 189 233 290 332 373 426 477 515 552 588 634 678 711 743 774 813 850 851 852 853 854 56 855 856 164 857 267 406 858 859 860 861 862 863 864 865 866 867 868 869 870 458 619 664 871 872 841 803 873 874 875 876 877 878 879 880 881 882 883 884 885;
    21 84 130 190 234 291 333 374 427 478 516 553 589 635 679 712 744 775 814 851 886 887 888 889 36 890 891 144 892 247 386 893 894 895 896 897 898 899 900 901 902 903 904 905 438 600 646 906 907 825 786 908 909 910 911 862 912 913 914 915 916 917 918 919;
    22 85 131 191 235 292 334 375 428 479 517 554 590 636 680 713 745 776 815 852 887 920 921 922 22 923 924 131 925 235 375 926 927 928 929 887 930 931 932 933 934 935 925 936 428 590 636 937 938 815 776 939 940 941 942 852 929 943 944 928 945 930 946 933;
    23 86 132 192 236 293 335 376 429 480 518 555 591 637 681 714 746 777 816 853 888 921 947 948 23 949 950 132 951 236 376 952 953 954 955 888 956 957 958 959 960 961 951 962 429 591 637 963 964 816 777 965 966 967 968 853 955 969 970 954 971 956 972 959;
    24 87 133 193 237 294 336 377 430 481 519 556 592 638 682 715 747 778 817 854 889 922 948 973 24 974 975 133 976 237 377 977 978 979 980 889 981 982 983 984 985 986 976 987 430 592 638 988 989 817 778 990 991 992 993 854 980 994 995 979 996 981 997 984;
    25 2 28 4 30 6 7 31 45 10 11 12 46 47 15 16 17 51 50 56 36 22 23 24 1 26 27 3 43 5 8 32 33 60 57 21 62 38 39 64 41 42 29 44 9 13 14 48 49 19 18 52 53 54 55 20 35 58 59 34 61 37 63 40;
    26 88 134 194 238 295 337 378 431 482 520 557 593 639 683 716 748 779 818 855 890 923 949 974 26 998 999 134 1000 238 378 1001 1002 1003 1004 890 1005 1006 1007 1008 1009 1010 1000 1011 431 593 639 1012 1013 818 779 1014 1015 1016 1017 855 1004 1018 1019 1003 1020 1005 1021 1008;
    27 89 135 195 239 296 338 379 432 483 521 558 594 640 684 717 749 780 819 856 891 924 950 975 27 999 1022 135 1023 239 379 1024 1025 1026 1027 891 1028 1029 1030 1031 1032 1033 1023 1034 432 594 640 1035 1036 819 780 1037 1038 1039 1040 856 1027 1041 1042 1026 1043 1028 1044 1031;
    28 66 136 113 138 115 116 139 153 119 120 121 154 155 124 125 126 159 158 164 144 131 132 133 3 134 135 112 151 114 117 140 141 168 165 130 170 146 147 172 149 150 137 152 118 122 123 156 157 128 127 160 161 162 163 129 143 166 167 142 169 145 171 148;
    29 90 137 196 240 297 339 380 433 484 522 559 595 641 685 718 750 781 820 857 892 925 951 976 43 1000 1023 151 1045 254 393 1046 1047 1048 1049 904 1050 1051 1052 1053 1054 1055 1056 1057 445 607 653 1058 1059 832 793 1060 1061 1062 1063 869 1064 1065 1066 1067 1068 1069 1070 1071;
    30 68 138 174 241 219 220 242 256 223 224 225 257 258 228 229 230 262 261 267 247 235 236 237 5 238 239 114 254 218 221 243 244 271 268 234 273 249 250 275 252 253 240 255 222 226 227 259 260 232 231 263 264 265 266 233 246 269 270 245 272 248 274 251;
    31 71 139 177 242 278 320 381 395 363 364 365 396 397 368 369 370 401 400 406 386 375 376 377 8 378 379 117 393 221 361 382 383 410 407 374 412 388 389 414 391 392 380 394 362 366 367 398 399 372 371 402 403 404 405 373 385 408 409 384 411 387 413 390;
    32 91 140 197 243 298 340 382 434 485 523 560 596 642 686 719 751 782 821 858 893 926 952 977 32 1001 1024 140 1046 243 382 1072 1073 1074 1075 893 1076 1077 1078 1079 1080 1081 1046 1082 434 596 642 1083 1084 821 782 1085 1086 1087 1088 858 1075 1089 1090 1074 1091 1076 1092 1079;
    33 92 141 198 244 299 341 383 435 486 524 561 597 643 687 720 752 783 822 859 894 927 953 978 33 1002 1025 141 1047 244 383 1073 1093 1094 1095 894 1096 1097 1098 1099 1100 1101 1047 1102 435 597 643 1103 1104 822 783 1105 1106 1107 1108 859 1095 1109 1110 1094 1111 1096 1112 1099;
    34 93 142 199 245 300 342 384 436 487 525 562 598 644 688 721 753 784 823 860 895 928 954 979 60 1003 1026 168 1048 271 410 1074 1094 1113 1114 915 1115 1116 1117 1118 1119 1120 1067 1121 462 623 668 1122 1123 845 807 1124 1125 1126 1127 881 1128 1129 1130 1131 1132 1133 1134 1135;
    35 94 143 200 246 301 343 385 437 488 526 563 599 645 689 722 754 785 824 861 896 929 955 980 57 1004 1027 165 1049 268 407 1075 1095 1114 1136 912 1137 1138 1139 1140 1141 1142 1064 1143 459 620 665 1144 1145 842 804 1146 1147 1148 1149 878 1150 1151 1152 1128 1153 1154 1155 1156;
    36 84 144 190 247 291 333 386 438 478 516 553 600 646 679 712 744 786 825 862 897 887 888 889 21 890 891 130 904 234 374 893 894 915 912 886 917 899 900 919 902 903 892 905 427 589 635 906 907 814 775 908 909 910 911 851 896 913 914 895 916 898 918 901;
    37 95 145 201 248 302 344 387 439 489 527 564 601 647 690 723 755 787 826 863 898 930 956 981 62 1005 1028 170 1050 273 412 1076 1096 1115 1137 917 1157 1158 1159 1160 1161 1162 1069 1163 464 625 670 1164 1165 847 809 1166 1167 1168 1169 883 1154 1170 1171 1133 1172 1173 1174 1175;
    38 96 146 202 249 303 345 388 440 490 528 565 602 648 691 724 756 788 827 864 899 931 957 982 38 1006 1029 146 1051 249 388 1077 1097 1116 1138 899 1158 1176 1177 1178 1179 1180 1051 1181 440 602 648 1182 1183 827 788 1184 1185 1186 1187 864 1138 1188 1189 1116 1190 1158 1191 1178;
    39 97 147 203 250 304 346 389 441 491 529 566 603 649 692 725 757 789 828 865 900 932 958 983 39 1007 1030 147 1052 250 389 1078 1098 1117 1139 900 1159 1177 1192 1193 1194 1195 1052 1196 441 603 649 1197 1198 828 789 1199 1200 1201 1202 865 1139 1203 1204 1117 1205 1159 1206 1193;
    40 98 148 204 251 305 347 390 442 492 530 567 604 650 693 726 758 790 829 866 901 933 959 984 64 1008 1031 172 1053 275 414 1079 1099 1118 1140 919 1160 1178 1193 1207 1208 1209 1071 1210 466 627 672 1211 1212 849 811 1213 1214 1215 1216 885 1156 1217 1218 1135 1219 1175 1220 1221;
    41 99 149 205 252 306 348 391 443 493 531 568 605 651 694 727 759 791 830 867 902 934 960 985 41 1009 1032 149 1054 252 391 1080 1100 1119 1141 902 1161 1179 1194 1208 1222 1223 1054 1224 443 605 651 1225 1226 830 791 1227 1228 1229 1230 867 1141 1231 1232 1119 1233 1161 1234 1208;
    42 100 150 206 253 307 349 392 444 494 532 569 606 652 695 728 760 792 831 868 903 935 961 986 42 1010 1033 150 1055 253 392 1081 1101 1120 1142 903 1162 1180 1195 1209 1223 1235 1055 1236 444 606 652 1237 1238 831 792 1239 1240 1241 1242 868 1142 1243 1244 1120 1245 1162 1246 1209;
    43 90 151 196 254 297 339 393 445 484 522 559 607 653 685 718 750 793 832 869 904 925 951 976 29 1000 1023 137 1056 240 380 1046 1047 1067 1064 892 1069 1051 1052 1071 1054 1055 1045 1057 433 595 641 1058 1059 820 781 1060 1061 1062 1063 857 1049 1065 1066 1048 1068 1050 1070 1053;
    44 101 152 207 255 308 350 394 446 495 533 570 608 654 696 729 761 794 833 870 905 936 962 987 44 1011 1034 152 1057 255 394 1082 1102 1121 1143 905 1163 1181 1196 1210 1224 1236 1057 1247 446 608 654 1248 1249 833 794 1250 1251 1252 1253 870 1143 1254 1255 1121 1256 1163 1257 1210;
    45 72 153 178 256 279 321 395 447 416 417 418 448 449 421 422 423 453 452 458 438 428 429 430 9 431 432 118 445 222 362 434 435 462 459 427 464 440 441 466 443 444 433 446 415 419 420 450 451 425 424 454 455 456 457 426 437 460 461 436 463 439 465 442;
    46 76 154 182 257 283 325 396 448 470 508 545 609 610 583 584 585 614 613 619 600 590 591 592 13 593 594 122 607 226 366 596 597 623 620 589 625 602 603 627 605 606 595 608 419 581 582 611 612 587 586 615 616 617 618 588 599 621 622 598 624 601 626 604;
    47 77 155 183 258 284 326 397 449 471 509 546 610 655 629 630 631 659 658 664 646 636 637 638 14 639 640 123 653 227 367 642 643 668 665 635 670 648 649 672 651 652 641 654 420 582 628 656 657 633 632 660 661 662 663 634 645 666 667 644 669 647 671 650;
    48 102 156 208 259 309 351 398 450 496 534 571 611 656 697 730 762 795 834 871 906 937 963 988 48 1012 1035 156 1058 259 398 1083 1103 1122 1144 906 1164 1182 1197 1211 1225 1237 1058 1248 450 611 656 1258 1259 834 795 1260 1261 1262 1263 871 1144 1264 1265 1122 1266 1164 1267 1211;
    49 103 157 209 260 310 352 399 451 497 535 572 612 657 698 731 763 796 835 872 907 938 964 989 49 1013 1036 157 1059 260 399 1084 1104 1123 1145 907 1165 1183 1198 1212 1226 1238 1059 1249 451 612 657 1259 1268 835 796 1269 1270 1271 1272 872 1145 1273 1274 1123 1275 1165 1276 1212;
    50 82 158 188 261 289 331 400 452 476 514 551 613 658 677 710 742 797 836 841 825 815 816 817 19 818 819 128 832 232 372 821 822 845 842 814 847 827 828 849 830 831 820 833 425 587 633 834 835 812 773 837 838 839 840 813 824 843 844 823 846 826 848 829;
    51 81 159 187 262 288 330 401 453 475 513 550 614 659 676 709 741 798 797 803 786 776 777 778 18 779 780 127 793 231 371 782 783 807 804 775 809 788 789 811 791 792 781 794 424 586 632 795 796 773 772 799 800 801 802 774 785 805 806 784 808 787 810 790;
    52 104 160 210 263 311 353 402 454 498 536 573 615 660 699 732 764 799 837 873 908 939 965 990 52 1014 1037 160 1060 263 402 1085 1105 1124 1146 908 1166 1184 1199 1213 1227 1239 1060 1250 454 615 660 1260 1269 837 799 1277 1278 1279 1280 873 1146 1281 1282 1124 1283 1166 1284 1213;
    53 105 161 211 264 312 354 403 455 499 537 574 616 661 700 733 765 800 838 874 909 940 966 991 53 1015 1038 161 1061 264 403 1086 1106 1125 1147 909 1167 1185 1200 1214 1228 1240 1061 1251 455 616 661 1261 1270 838 800 1278 1285 1286 1287 874 1147 1288 1289 1125 1290 1167 1291 1214;
    54 106 162 212 265 313 355 404 456 500 538 575 617 662 701 734 766 801 839 875 910 941 967 992 54 1016 1039 162 1062 265 404 1087 1107 1126 1148 910 1168 1186 1201 1215 1229 1241 1062 1252 456 617 662 1262 1271 839 801 1279 1286 1292 1293 875 1148 1294 1295 1126 1296 1168 1297 1215;
    55 107 163 213 266 314 356 405 457 501 539 576 618 663 702 735 767 802 840 876 911 942 968 993 55 1017 1040 163 1063 266 405 1088 1108 1127 1149 911 1169 1187 1202 1216 1230 1242 1063 1253 457 618 663 1263 1272 840 802 1280 1287 1293 1298 876 1149 1299 1300 1127 1301 1169 1302 1216;
    56 83 164 189 267 290 332 406 458 477 515 552 619 664 678 711 743 803 841 877 862 852 853 854 20 855 856 129 869 233 373 858 859 881 878 851 883 864 865 885 867 868 857 870 426 588 634 871 872 813 774 873 874 875 876 850 861 879 880 860 882 863 884 866;
    57 94 165 200 268 301 343 407 459 488 526 563 620 665 689 722 754 804 842 878 912 929 955 980 35 1004 1027 143 1064 246 385 1075 1095 1128 1150 896 1154 1138 1139 1156 1141 1142 1049 1143 437 599 645 1144 1145 824 785 1146 1147 1148 1149 861 1136 1151 1152 1114 1153 1137 1155 1140;
    58 108 166 214 269 315 357 408 460 502 540 577 621 666 703 736 768 805 843 879 913 943 969 994 58 1018 1041 166 1065 269 408 1089 1109 1129 1151 913 1170 1188 1203 1217 1231 1243 1065 1254 460 621 666 1264 1273 843 805 1281 1288 1294 1299 879 1151 1303 1304 1129 1305 1170 1306 1217;
    59 109 167 215 270 316 358 409 461 503 541 578 622 667 704 737 769 806 844 880 914 944 970 995 59 1019 1042 167 1066 270 409 1090 1110 1130 1152 914 1171 1189 1204 1218 1232 1244 1066 1255 461 622 667 1265 1274 844 806 1282 1289 1295 1300 880 1152 1304 1307 1130 1308 1171 1309 1218;
    60 93 168 199 271 300 342 410 462 487 525 562 623 668 688 721 753 807 845 881 915 928 954 979 34 1003 1026 142 1067 245 384 1074 1094 1131 1128 895 1133 1116 1117 1135 1119 1120 1048 1121 436 598 644 1122 1123 823 784 1124 1125 1126 1127 860 1114 1129 1130 1113 1132 1115 1134 1118;
    61 110 169 216 272 317 359 411 463 504 542 579 624 669 705 738 770 808 846 882 916 945 971 996 61 1020 1043 169 1068 272 411 1091 1111 1132 1153 916 1172 1190 1205 1219 1233 1245 1068 1256 463 624 669 1266 1275 846 808 1283 1290 1296 1301 882 1153 1305 1308 1132 1310 1172 1311 1219;
    62 95 170 201 273 302 344 412 464 489 527 564 625 670 690 723 755 809 847 883 917 930 956 981 37 1005 1028 145 1069 248 387 1076 1096 1133 1154 898 1173 1158 1159 1175 1161 1162 1050 1163 439 601 647 1164 1165 826 787 1166 1167 1168 1169 863 1137 1170 1171 1115 1172 1157 1174 1160;
    63 111 171 217 274 318 360 413 465 505 543 580 626 671 706 739 771 810 848 884 918 946 972 997 63 1021 1044 171 1070 274 413 1092 1112 1134 1155 918 1174 1191 1206 1220 1234 1246 1070 1257 465 626 671 1267 1276 848 810 1284 1291 1297 1302 884 1155 1306 1309 1134 1311 1174 1312 1220;
    64 98 172 204 275 305 347 414 466 492 530 567 627 672 693 726 758 811 849 885 919 933 959 984 40 1008 1031 148 1071 251 390 1079 1099 1135 1156 901 1175 1178 1193 1221 1208 1209 1053 1210 442 604 650 1211 1212 829 790 1213 1214 1215 1216 866 1140 1217 1218 1118 1219 1160 1220 1207
]

@testset "numerical issues" begin

    part = SDPSymmetryReduction.Partition(P)

    function try_fail_eigen_decomposition(part, epsilon, niterates)
        A = SDPSymmetryReduction.randomize(Float64, part)
        print("testing for numerical issues ('·'/100it): ")
        res = niterates, nothing
        for c in 1:niterates
            if c % 100 == 0
                print('·')
            end
            try
                SDPSymmetryReduction.eigen_decomposition(part, A, atol=epsilon)
            catch err
                res = (c, err)
                break
            end
        end
        println(" done!")
        return res
    end

    N = 10_000
    eps = 1e-7
    res = try_fail_eigen_decomposition(part, eps, N)
    @test res == (N, nothing)
end
